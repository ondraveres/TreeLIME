try
    cd("/Users/ondrejveres/Diplomka/ExplainMill.jl/myscripts/cape")
catch
    cd("/home/veresond/ExplainMill.jl/myscripts/cape")
end
using Pkg
Pkg.activate("..")

using ArgParse, Flux, Mill, JsonGrinder, JSON, BSON, Statistics, IterTools, PrayTools, StatsBase, ExplainMill, Serialization, Setfield, DataFrames, HierarchicalUtils, Random, JLD2, GLMNet, Plots, Zygote
using ExplainMill: jsondiff, nnodes, nleaves
using ProgressMeter

# @time @load "cape_model_variables_equal.jld2" labelnames df_labels time_split_complete_schema extractor data model #takes 11 minutes
# supertype(supertype(typeof(sch)))
@time @load "cape_equal_extractor.jld2" extractor sch model data #takes 15 minutes
printtree(sch)
printtree(extractor)


include("../datasets/common.jl")
include("../datasets/loader.jl")
include("../datasets/stats.jl")

sample_num = 1



statlayer = StatsLayer()
model = @set model.m = Chain(model.m, statlayer)
soft_model = @set model.m = Chain(model.m, softmax)
logsoft_model = @set model.m = Chain(model.m, logsoftmax)
Random.seed!(1)



ds = data[1:min(numobs(data), sample_num)]
model_variant_k = 3

predictions = Flux.onecold((model(ds)))
# first_indices = Dict(value => findall(==(value), predictions)[1:min(end, 100)] for value in unique(predictions))
# first_indices
# sorted = sort(first_indices)

exdf = DataFrame()

# @showprogress 1 "Processing..." for (class, sample_indexes) in pairs(sorted)
#     @showprogress "Processing samples..." for sample_index in sample_indexes
# @showprogress "Processing observations..." for j in 1:numobs(ds)
#     for c in [0.5]
#         global exdf
#         exdf = add_cape_treelime_experiment(exdf, ds[j], logsoft_model, predictions[j], j, statlayer, extractor, sch, 10, model_variant_k, c, "sample")
#         exdf = add_cape_treelime_experiment(exdf, ds[j], logsoft_model, predictions[j], j, statlayer, extractor, sch, 100, model_variant_k, c, "missing")
#         exdf = add_cape_treelime_experiment(exdf, ds[j], logsoft_model, predictions[j], j, statlayer, extractor, sch, 100, model_variant_k, c, "sample")
#         exdf = add_cape_treelime_experiment(exdf, ds[j], logsoft_model, predictions[j], j, statlayer, extractor, sch, 10, model_variant_k, c, "missing")
#         #exdf = add_cape_treelime_experiment(exdf, ds[j], logsoft_model, predictions[j], j, statlayer, extractor, sch, 1000, model_variant_k, c, "missing")
#         #exdf = add_cape_treelime_experiment(exdf, ds[j], logsoft_model, predictions[j], j, statlayer, extractor, sch, 1000, model_variant_k, c, "sample")
#         #exdf = add_cape_treelime_experiment(exdf, ds[j], logsoft_model, predictions[j], j, statlayer, extractor, sch, 10000, model_variant_k, c, "missing")
#         #exdf = add_cape_treelime_experiment(exdf, ds[j], logsoft_model, predictions[j], j, statlayer, extractor, sch, 10000, model_variant_k, c, "sample")
#     end
# end
typeof(name)
# Base.eps(::Type{Any}) = eps(Float32)
# Base.typemin(::Type{Any}) = typemin(Float32)
variants =    [#("banz", :Flat_HAdd),
#("lime_10_s_0.5", :Flat_HAdd),
#("lime_100_s_0.5", :Flat_HAdd),
#("lime_100_m_0.5", :Flat_HAdd),
("lime_1000_m_0.5", :Flat_HAdd),
            #("lime_15_s_0.5", :Flat_HAdd)
            ]
#getVariants()
@showprogress "Processing variants..." for (name, pruning_method) in variants # vcat(variants, ("nothing", "nothing"))
    e = getexplainer(name; sch, extractor)
    @info "explainer $e on $name with $pruning_method"
    for j in 1:numobs(ds)
        global exdf
        # try
        exdf = add_cape_experiment(exdf, e, ds[j], logsoft_model, predictions[j], 0.0005, name, pruning_method, j, statlayer, extractor, model_variant_k)
        # catch e
        #     println("fail")
        #     println(e)
        # end
    end
end
#     end
# end
# exdf
# printtree(ds[10])
# logsoft_model(ds[10])
# vscodedisplay(exdf)
# @save "extra_valuable_cape_ex_big.bson" exdf
# @load "../datasets/extra_valuable_cape_ex_big.bson" exdf
# exdf

new_df = select(exdf, :name, :pruning_method, :time, :gap, :original_confidence_gap, :nleaves, :explanation_json)
transform!(new_df, :time => (x -> round.(x, digits=2)) => :time)
transform!(new_df, :gap => (x -> first.(x)) => :gap, :original_confidence_gap => (x -> first.(x)) => :original_confidence_gap)
vscodedisplay(new_df)


banz = [0.0008842982662220777, -0.000711161958842646, -0.00105876801310531, 0.0033414945330308837, 5.1455329293792484e-5, -0.0005699853599071547, -0.0003234070890090063, 0.0005999549048669173, -0.0009518404109164769, 0.00028526217115072694, 0.0010443202975664728, 0.00024357869400251642, -0.0008194636201004912, 0.00044540334718325136, 0.00019994265392048183, 2.6470714474022272e-5, -0.0001034463892559262, 0.00031020708869620994, 0.0009320249902282779, 0.0002969977899621584, 0.0010112013178642382, -0.00035695595045884265, -0.0006155165351357794, 0.000394616529362124, 3.106512275397044e-5, 0.0005324917124905626, 0.0008306944613936662, 0.0022009550840005054, 0.00247995649533396, 0.0014289198870888475, -7.641973376971978e-5, 0.00024108385497872975, 0.004275640314246751, 0.0023420458915186793, 0.00011165598733726967, -4.517098267872721e-5, 0.0012228232036052694, 0.0017403846482435953, 0.0002569962115514801, 0.0004712594553637206, -0.0003617130724111045, 0.0012420730394279017, -0.0009545273350593797, 0.0006691528856754281, 0.003292658700699197, -0.0005232512609477796, -0.0002584728327664487, 0.0023851136392378236, 0.00027781096819842754, 0.00017081343739254462, -0.0008087789668899392, 0.0012490233681853313, -1.4753745059770118e-5, 0.0008057722110967197, 0.0005892000251962876, -0.0013323306070210789, 5.79410849453621e-6, 0.001675422149415573, -0.0008204376992252543, 0.0005772641131606554, -0.0010783543355178116, -0.0008593657419116718, -0.0016544866090526383, 0.0023764763759878405, -0.0014188931251947756, 0.0008308452189616511, -0.000398652926869289, -0.0011887934010774287, 0.00031607791284769815, -0.0005076868925849021, -0.002094055839639633, -0.00019240529102061699, -0.002496775904936452, 0.001758239790797228, -0.00021451620699522445, -0.0011219501402719018, -0.0010574778461672485, 0.00017376067933444483, -0.001040373680492243, 0.0025889747404085617, -0.0005802370090482734, -6.370450292737806e-5, -0.0005681316554546345, 0.0007085755660936333, 0.0010656210753403061, -0.00044945380292259196, -0.0006437727383204889, 0.0014290877586401601, 0.0005372272366109959, 0.00036460948440264485, -0.0007436845569147171, 0.00047742712780857177, 0.00047972342822075187, 0.0010233340637066518, -0.000625998192986893, -0.00010839929708686413, 5.303749763278798e-5, -3.3017068710880504e-5, 0.0005618185401201348, -0.0008319626390257406, 0.0015666037328353477, 0.001754779745602883, -0.00029736383978130887, -0.0013485196094026597, 0.001927868808312902, -0.0017063156782036876, 0.0007628182756404117, 4.874694471558583e-5, 0.00024971337615393996, -0.0008242376758466896, 0.0013914999321230498, -0.0018961358917891635, 0.001801922538457415, 1.4731567474321472e-5, -0.0005138514673008604, 0.001009574846644351, -0.00059748713865998, -0.00010619521215807226, -0.0010581985690216317, -0.00024446911577667707, -0.0012837711575568872, -0.0005981627575777221, 0.0003687406452041325, 0.00030392494339209764, 0.0019245328030724485, -0.0026536763887920617, -0.003649353362650043, -0.0003389064222574234, 0.00011250070887756924, 0.00042955583017884047, -0.00032744462750539105, -0.0011939727898799962, 0.0008971755900843564, -0.00041440364970876664, 0.0006959604312352374, 0.0015680342314473988, 0.0001631180146583061, -0.0005784755543289111, 0.0014536244180196334, -0.0004669323312694318, 0.0003967061877632738, -0.00016860067844391702, 0.00014549894141673014, 0.0004194188542748223, -0.0007784443111026607, 0.0018190382747354517, 0.0003391857084241029, -0.0010289776511490378, 0.0013439848002893828, 0.0022381417398205927, 0.0018876040867819854, 0.00272287355292411, 0.002303653242332601, 0.0016521222709694472, 0.0007514031264795329, -0.000413741826568767, -0.002506572029728815, 0.0022500889641898086, 0.0008693334014936438, -0.0007810604264505416, -0.0006543041255468729, -0.000292239475235323, 0.00038649325230807885, 0.00034335086407150106, 0.00046979469292256215, 0.000601217918789268, 0.0001570158013824291, 0.0005946808161128442, 5.477854619087563e-5, -0.0016795446475346837, 0.0008185787050232068, -0.0006128316236319042, 0.0009382803781781968, 5.807201015903263e-5, -0.0005878701249742435, 5.3966876351493887e-5, 0.0018578445421067458, -0.0009542202541787392, 0.00032379840792565173, 0.0008989988636408791, 0.00068524325649226, 0.001332986937819608, 0.0004636873469114622, -3.306090831756148e-5, -0.00029804799401859927, -6.845444080910701e-5, 0.0007462609029366685, 0.000609826554518772, 0.0008421134478293069, -0.0010885600458111627, -0.00022865062603702468, -0.0007452732768236242, -0.0009609878021273194, 0.00015193291856513413, -0.0002427432331779944, -0.0008363279700279308, -5.7942508600458686e-5, 0.000743772571248219, -0.002054257374590307, 0.0009508934279944675, 0.0005255249105677179, -4.527791581972196e-5, -0.0013042449054861405, 0.0004709663423090177, 0.00042862217295767946, 0.0008159946379506233, 0.00034570241525229417, -0.001183599200815233, 0.0009350616795321259, -0.0015861883087977396, -0.0007587202680934685, 0.0007663801246855229, -0.00070163421314208, 3.528550267219155e-5, -0.0005121595727709677, 0.0003971208904079704, -0.00026524769991108366, 0.000717688919831011, -0.00024239723533854562, 5.250015095169258e-5, 0.00013722046430177104, 0.0013281089702138205, -0.00024017009188184724, 0.002019956645866239, -0.002291860922493727, -0.0018641058828622603, -0.0004130954332385445, -0.0010644868192379725, 0.0007625868661099711, 0.001473109332331718, -0.0008659252601246892, 0.001774235579302938, 0.0013629486409976327, -0.00016853506817961217, -0.0012871188622328583, -0.0003161758832588568, -0.0016560214140066282, 0.000446194535112146, 0.0006002530254961697, 0.0013657550162756021, 0.0013015348407806882, 0.000374518042914912, 0.0011794649379787414, -0.0013828140168965358, 0.0020042491973827625, 0.0003002264750293082, -0.000196605566002081, 0.0011857645002827516, 0.000843467017462296, 0.0003910345331676057, -0.000520106178688487, -0.00019446053532895524, -0.00029738326656057745, -0.0011544716922012588, 0.0010473111787667605, -1.7257158954897545e-6, 0.00021748813490073127, 0.0010646667745378285, -0.0001651378016370303, 0.00034835056254738095, 0.000602419844298846, 0.0018382820542211936, 0.0015780079903754685, 0.002783382205026483, 2.5604071538731787e-5, 0.0005086133274815885, 0.00021164983685252603, 0.0006008969219269827, -0.0006566742737710157, 0.00044008810073137283, 0.00023330533421123123, 0.000601057879745015, 0.0008014049824504738, -0.0009474106366727936, -0.00047926582614372937, 0.0009067711512918547, -0.00036817202039719776, -0.0011112920631461132, -0.0017163419188597206, -0.0012075379758473836, 0.0009521949023612308, -0.00011637352047372262, -0.000894944553346752, 0.00226227702628759, -0.0017102492194702307, 0.0010172221350845945, -0.0004902738332748374, -1.2118341017358647e-5, -0.00045985509457811824, -0.0009689267944590907, -0.0004549030154832323, -0.00030152203932092003, -0.0022218429100087783, -0.0007459915553530011, 0.0017155368426955697, 0.0005677740457114416, 0.0005747958092298944, 0.0002605106900543386, 0.0012124669642775698, -0.0006338649237075944, -9.875889111281289e-5, -0.0005745128700408719, 0.0013589217800979991, -0.0003396557325742594, -0.0003697404993547315, -0.00045815919973439534, -0.0012438738993249543, 0.00018160320961704834, 1.1637981253420637e-5, -0.0010938514144970268, -0.0003229851404634859, 0.0009283157659559643, -0.0017766595628547627, 0.0004472101323339389, 0.0017100451361326957, -0.0009093677022066898, -0.0006425026294305941, -0.0004894593681030457, -0.00013801567030674589, -0.003632154439439192, -0.0018758835973545912, -0.0018383309032615203, -0.0011641944141855265, 0.00021516417604673654, 0.00020569441123650944, -2.9731119077419654e-5, 0.0017609084581399898, 0.00018897402511984518, 0.0008540919947403469, 0.003027319103333065, -2.277877272628681e-5, 0.0005925537430142153, -0.0002010332726898323, -4.0771084407642544e-5, -0.00013346754806765893, 0.002263186692066904, -0.00024775153663679494, -0.0024410228761674174, 0.0006721881649557754, 0.00015925817812482979, 0.00014503459100956295, -0.0016665434956831815, -0.0011860597257812716, 0.0007522562740459315, -0.0008285353085744074, 0.0003301334221448293, -0.0004862882502363747, -0.0012930354014748513, 0.00043429527972145554, -0.0015098278545036953, -0.00044386443041380397, 0.001249814729813059, 0.0012958858246193694, 0.0007978890559496576, -0.0012867713264077124, -0.0002996901802274493, -0.001954714603283822, 0.0009549905466181841, -0.0010884562134742676, 0.0017962743690799199, 0.0003425259405304554, 0.00040632608846191687, 0.0014108789910690367, 0.0011433883226886765, 0.0005978646988901992, 0.0032554010739145045, 0.003024486339865254, -0.0008679554721041371, 0.0003929642645626452, 0.0006326272216661266, 6.40965687731948e-5, -7.281744561718484e-5, 0.00023986756801605558, 0.0018378245929969034, 0.0010148937512942796, 0.0009628382165629834, 0.0008840770503975998, 4.115503956331201e-5, -0.0008986724486101522, 0.0011921947483311962, -0.00012041754288152906, -0.001348463382619694, 0.00022165164617556077, -0.0017189553506989919, 0.0005781990177451818, 0.0007001280784606906, -4.221448281994944e-5, -0.00029880774407542443, -0.0004502188784476363, -1.6441640227723986e-5, 0.001407097111276831, 0.0013719406928560524, 0.00040432823980871, 0.0015927317378285205, 0.0008349136450992861, -0.0015780856069794458, -0.00028593831210627085, -0.000696451015149549, -1.0745746450019356e-5, 0.000665037823201417, 0.0006116667782719853, -0.00014814765158385756, 0.00020207509398460777, 0.0010727214581873756, -0.000220353489625999, 0.0008917096068231101, 5.203695448890988e-5, 0.0002041815221309612, -0.001035048303278191, -0.00019278221560599385, 0.00030356814878226834, 0.0001919181874566328, -0.0002807883227302216, 0.0002030350712119433, -0.0005823937353223174, 0.000585312588054554, 0.0010621871064309257, 5.529932963573014e-5, -0.00027023717658211655, -0.0005273903333037622, 0.0010371252707670336, 0.0012022631073539958, -0.0007776536047458676, 0.0005897612808440644, -0.00040083896893662596, -0.0010848134681395727, -0.001277482434481142, 5.972322664762886e-5, 0.0015957053476132743, -0.0012009085928383623, -0.0006507995173137687, -0.00012770124009343908, -0.0001244071313148548, -0.0006658909033660509, -0.0005432237242046084, -0.0009008788083844921, -0.001500552041190012, 0.0014667002878223506, 0.000583351348285327, 0.0008681362423510058, 0.00031656561975494657, -0.00022661134600639177, -0.00015250146866609138, -0.0001480730553916204, -0.0015792993624226814, -0.0008820858246718494, -0.0009463420786654381, 0.0008673995003457141, 0.0005591044535383505, -0.0004411601729918946, -0.0006426624334570363, -0.00017716654560022416, 0.000985215662144906, -0.0011018193430370748, 0.0005384854623535773, 0.00012844337942322093, 0.00048095958329925914, -0.0005370554296517532, 0.0007369607946510204, 0.0006098114312268199, 0.0011200977891099168, 0.001678104154249821, 0.0003430266351176353, -0.0004470123221044925, -1.4497349277442506e-6, 0.0006641527763883021, 0.0009309092166427529, 1.2102676330560946e-5, 0.00039732187986374345, -0.0005931621043606394, -0.001050912318074318, -0.00020123113137789084, -0.0004050779098266899, -0.00047821039507082996, 0.00029010345463764686, 0.0005759324830694051, 0.0002866694361868538, -0.0005233320109068601, -0.00012155951875628124, 0.001440304891208652, -0.00024822739639666913, -0.0005984899435729774, -0.0006284348720214938, 0.0004202977470729591, 0.00010170942207551881, -0.001237541926102717, -0.0003463364185247314, -0.0004666235219933229, 0.0005072231502812469, 0.00016720784474687223, -0.00018279062187499806, -0.0006625560889566701, -0.0010982688805811908, 7.221000153524726e-5, 0.0011590603901510815, -9.044186404533194e-5, 0.0013667611847034689, 0.0011134371161460876, -6.234795093917889e-5, -0.00034104977947120585, 0.00031783415370580104, -0.00034308514811776103, 0.0006404786779169447, -0.0008411659699242013, 2.0906022176969685e-5, -4.5220077703092554e-5, 0.0012950576337656533, -0.0014487230154213576, 0.0002792780101299325, -8.598925084783715e-5, 0.0007767050969405137, -0.0009286999702453613, -0.0010366479043114468, 0.0007758317137123022, 0.0005493917478582855, 0.0011877856822628402, -0.00019605710084634465, 0.000872342446313179, 0.00013286590576171153, 0.00011476818570956004, 0.0005861486094482782, -0.00020871641057909618, 0.0006978141777620878, -0.0010772634108567047, 0.00021522462654227636, -0.0003666686467253266, -0.0004521656331075846, 0.0007768562636854132, -0.0010630814202801514, 0.001400647453963011, -0.00015944554490521234, 0.0001592515217890278, 0.0004583323470776085, 0.00024237085764544641, -0.0008259049843614696, 0.0008675580911958053, 0.00023067583117568347, -0.0003500420318229558, 0.0002554708029119668, -0.0003141746768127035, 0.0007882104673160167, -4.1783682816626255e-6, 0.0003025497791040721, 0.0010557085434693553, -0.0002630950690819117, 0.00036137469859348625, 0.0020398646667786485, -0.000422073157508876, 0.0003852729243461611, -0.0009239945748839712, -0.00017343612684719845, 0.0005199766996260152, -0.0004906522888610682, 0.000900575548711452, 7.781038308203592e-5, -0.00021299400969902738, -0.001299948351723798, 0.0004337366794099212, 0.001050119088074869, 0.0005680755072949017, 0.0009320010424068992, -0.0004658152285370726, 8.186906576156117e-5, -0.0011159341618206808, -0.0008742851653073813, 0.0008064944847355759, -0.00027689954690765517, -0.000735829861616355, -0.0005491155040572987, -0.0006300119949238653, -0.001699555665254593, 0.0017163698251048687, 0.0010465986332065247, -0.003100612853427956, -0.0007449952242968155, 0.001399547577257687, -0.002472510633917596, -0.0004563693338372893, -0.0014736343398844554, -2.8642227651587415e-6, 0.0018884409219026566, -0.0006945327229304632, -0.0024918473549616904, -0.0011112862849733118, -0.001416558696034173, 0.0019044696897045216, 0.0006868657422404723, -0.0007791165234865838, 0.0005934622715271648, -0.0002255096857310679, 0.0004456744722600159, -2.0805625688471996e-5, 0.0014490699904929488, 0.0010751827326264257, 0.0021341159135827986, 0.0027706768024519796, -0.00029606960262314186, -0.0021725265019591905, 0.0005765696973992762, 0.0017038990171008572, -0.0006729163978032443, -0.0022157384277637776, 0.0025697118558344334, -0.00055560758017284, 0.0010287307453255706, 0.0022712437355000142, -0.0006131438466791955, 0.0022954110614055584, -3.7330253557718573e-5, -0.0025115885668330618, -0.0003469879904114681, 0.0005580021354042453, -0.00021897356772253296, 0.001662098843781143, 0.00012410850245125893, 0.00031341080154691225, -0.0008024960971063644, -0.0016022520362617976, 0.0016487038694322081, -0.002779358222853384, -4.1495378200834265e-5, 0.001847844969744633, -0.0006448147949158073, -0.002597337437496669, 0.0004983607431252729, -0.00104484631231537, -0.00039274542169137616, -0.0005369825301678871, 0.0012449708368097029, 0.00206837249107851, 0.00138958123759092, -0.0008097707455606284, 9.342682790050572e-5, 0.0011946117423609487, -0.00043490822568083287, -0.0011413612244826482, 0.001260065746657324, -0.0006560589475878287, 0.0013714984100687694, -0.0002690165447355314, 0.0008333919932780876, -0.0010403103511773676, -0.0005948093409339633, 0.0012058538504135796, 0.00014261922854806597, 6.977801344223988e-5, -0.0011612492973891164, 0.000737017994238573, 0.0014842558883387535, -0.0007963993608258446, 0.00028252302245661276, -0.0008113635441165667, 0.00012624574915101605, 0.0007578920510907944, -0.0021915707561740855, -0.002050467800984737, 0.0022243968488877275, -0.0015726164464575504, -0.001503656002977985, -0.0004097716572384058, 0.000868236171264275, -0.001118237240158998, 0.0004585437719385743, -0.0014383861130767839, 0.0007093481872224167, -6.518337032247745e-5, -0.0011744381045191016, -8.913976606730878e-5, -0.0008800372087730546, -0.0010315299419264429, -0.00039616244949036705, 0.001191281811442485, -0.002114599948900245, 0.0006433661147445674, -0.0005673528432488667, 0.0015149764082533212, -0.0026179401514430795, -0.0011206718032325952, 0.00042282819998919197, -0.0020032394852513152, 0.0031210006276766455, 0.00014968439353803265, -0.0009275298011866828, -0.0003812061985768028, 0.0002130615296170174, -0.0012222061833489506, -0.0004773916055758748, 0.00021670679994721664, -0.0003290251173354991, -0.0011113983666540261, -0.0006308867670794804, 0.0005668649041557089, -0.0020157648876004824, -0.0009961884630762946, 0.0009588106057913381, 0.0003569959881513096, -0.0008609178391369848, -0.0017212810745249885, -0.0005102286550238005, 0.0013976233168726954, -8.489164213340561e-5, -0.00016396865248680115, 0.00016852227585459345, 8.529905792113712e-5, 0.0011848775086794189, -0.0011790744392267405, 0.0008947615354275573, -0.000144321471452713, 0.00036330910047868703, 0.0014531276179383518, -0.000801554854919076, -0.001510688880213426, -0.0006636038303056424, -0.0002640880023439679, 0.0017454281179001968, 0.00024198328714294948, -4.525902832661077e-6, -0.0029025577657009194, -0.0010652915648524663, -0.0007692871564753817, 0.0004295743419982234, -0.0007254154687481307, 0.0005366235246620499, -9.856189911564006e-5, 0.0003354558338732605, 0.0004335186477248537, 0.0005157658536183163, 0.0007972803362896325, 0.0004354546946740284, -0.0006952709671107088, -0.000842662135645808, 0.001646423978464942, -0.0010859390865441826, -0.00027785261294671626, 0.002949193446560111, -0.0007067913031007372, 0.0019617998349523436, 0.0003605349836024452, 0.0006222622123684407, -0.0005330329161623293, 0.0004980137590043648, -0.0013069923996001237, 0.0006745968263835028, -0.0020062869945739192, -7.785906394322528e-5, 0.0018554514633410957, 0.0010047862332276114, -0.000993506262699756, 0.0011470422389045776, -0.00043514952201961776, -0.0018063977176868556, -0.0021106923883310452, 0.0021539976001380134, -0.0014543870408740556, -0.0024664834291116405, -0.0013364921435551486, -0.0004892191946207491, 0.0004839895187683796, 0.000710647057432609, -0.0007986197756095353, 0.0010141503686706271, -0.00015570706677024704, 0.0014802530042681006, 0.0004634028918473615, -0.00022541540766170265, 0.001581096835434434, -0.0005590667401937643, -0.0016886193417674777, -0.0018271816556765658, -0.0021139362080085655, -0.001871311439658116, -0.001993672707888361, -0.004766733949517002, -0.0035890357866334016]
ridge = [0.0067764447002068755, 0.008060753502458167, 0.016679078783351634, 0.004101251553952449, 0.00954668495980169, 0.0054008436143302896, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.006629370056196178, 0.008032401322320328, 0.010522210905657971, 0.0006656046513560628, 0.0025614234676172094, 0.017226589270991664, 0.0020574710380363084, 0.0036878694827131913, 0.002651001174895197, 0.005241483704259022, 0.001773520881427388, 0.0011143428298746483, 0.002487481008630492, 0.0056736522133278315, 0.004444264665395999, 0.002515919980459069, 0.005097571634273472, 0.003252353652279082, 0.0, 0.0, 0.006431639263074938, 0.003744160552957568, 0.007500932679189159, 0.0005528345945806792, 0.008169505335274727, 0.0021449133642714173, 0.032109162336243086, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.002551052601042863, 0.012646118133563873, 0.005248157396947833, 0.0064330700210075455, 0.0021708485820674684, 0.003159446722449861, 0.003785575114793262, 0.0020175185611378058, 0.007245982093355575, 0.0020670206585009197, 6.705624167898087e-5, 0.008880695846641511, 0.0036649108904169675, 0.00210163310614243, 0.0037733112618676917, 0.003166102197130778, 0.015362389146220795, 0.0028281325181023316, 0.01221505561906481, 0.0018875138973081047, 0.002923959958156616, 0.004876974933976123, 0.004636557508854837, 0.010833975332612194, 0.0019785522536460032, 0.008461873451194228, 0.002797049626229629, 0.0, 0.006795127165103908, 0.008282570359439459, 0.005092871983605875, 0.002452355292537004, 0.0018857478930967345, 0.0030189785858921745, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.008370913703444944, 0.0038623787138266736, 0.0033546336641882882, 0.0020000311728159154, 0.001099017900392751, 0.001686835694595106, 0.005031363437806487, 0.014633043712616676, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.012224275876648623, 0.002727672065107164, 0.009355859825137071, 0.008198964536850413, 0.004084744524087126, 0.001715037843085369, 0.0031256351417599656, 0.007708372109173149, 0.006925981854236466, 0.0032832520413356506, 0.01481470007519422, 0.013799361004848871, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.004568691702409454, 0.0031036804553387976, 0.008420572495153494, 0.0003800040656672175, 0.0025135925162627975, 0.004866832987957037, 0.006122858144843061, 0.005138892010539393, 0.006891955488031565, 0.003975287544170691, 0.004352265833732024, 0.009226262477540558, 0.0027595606168912806, 1.0470991466518767e-5, 0.0011878674728463376, 3.59043874126097e-7, 0.0019241481215606935, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.011988547639986954, 0.0050431025383218964, 0.00012456862966956462, 0.008724902877434144, 0.014534456592018005, 0.003970081781719671, 0.00012679364992074514, 0.009010305617627874, 0.005412834717042145, 0.0034903319147403323, 0.004444573292606546, 0.004314214308368207, 0.0052585503975489415, 0.001830586936686419, 0.0010223089000601585, 0.006436657799174555, 0.013441173839821378, 0.007222670013132617, 0.00828702704863541, 0.003144672841165438, 0.0048971337969216325, 0.0028495381024503073, 0.0064086170260268804, 0.0024245436365348625, 0.006062790533109043, 0.012340763997447978, 0.008247496653882198, 0.0021190240166856053, 0.008689370745901046, 0.01109496072829599, 0.006432678537778255, 0.015015808893162914, 3.087279574218835e-5, 0.00253001842931232, 0.005902786146123287, 0.002429600412326259, 0.0030369979776074885, 0.006624531389385505, 0.0060610906377613965, 0.0036808228587488874, 0.01820247755791928, 0.007453071587355535, 0.003033474931108861, 0.0004125306575515203, 0.009812070208274631, 0.00022986764651631252, 0.013337286628535444, 0.0008483201896784131, 0.0006637258521795489, 0.004814002775756356, 0.0016828451782853761, 0.005178940034280522, 0.004551113759436113, 0.005505356067361995, 0.006595170205394323, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0034962896815340714, 0.007898240211108335, 0.008670958020308402, 0.00889246841038395, 0.004358824064130519, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.006815837769978263, 0.000404244955540721, 0.0054189132547972025, 0.0034368358593813647, 0.00414065592550522, 0.0015086382062059322, 0.003038297734189897, 0.0023089097732191285, 0.0087845127783588, 9.391771443031821e-5, 0.0009242437689776075, 0.0024485209288217574, 0.003976024817565549, 0.004223556968023891, 0.0011011413183683618, 0.005483456476086559, 0.0019793101753132966, 0.006572264419975178, 0.0043456151820971565, 0.005873142205061189, 0.0034598482414300237, 0.004939424891023512, 0.003406217519770866, 0.006007905900094528, 0.004376855988885929, 0.004506565348460084, 0.006791242482511121, 0.00759131037495502, 0.003391623902587757, 0.003716352702154862, 0.001652838911487664, 0.00894723410103132, 0.0035611912085781335, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0009886731477361046, 0.0018344240816832401, 0.0037809623418898148, 0.00783432261744427, 0.0029290443537168687, 0.0012954904229819065, 0.0, 0.0, 0.0, 0.004747888383033941, 0.004203270831937764, 0.0010897015876784736, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0049625920084012095, 0.010331160596425075, 0.0002934441714579785, 0.013360299054951768, 0.00223944308131691, 0.0031172201408718844, 0.008085836546790078, 0.012262415493959266, 0.00017190732091698264, 0.0029077144753339094, 0.002546996364703661, 0.0012305246900090965, 0.0033952557748500407, 0.000338584998832373, 0.004536055160135527, 0.012062490510196477, 0.005443886014036504, 0.00017198969943522913, 0.005937790411479136, 0.014863381180639798, 0.0010261007570654102, 0.0011685215533928767, 0.0009008578934855845, 0.018467325826901953, 0.003630302397357572, 0.0015739742237662552, 0.002995934729063066, 0.004422666793893305, 0.0006788341935176365, 0.013779596239580335, 0.0033526330866475735, 0.008899538414686615, 0.005470278420116273, 0.004603197420517205, 0.004635971992405257, 0.013424283240698135, 0.017693980794772902, 0.0010217177578465836, 0.004128573350128332, 0.008744036268677386, 0.002318807757869294, 0.0017353097159699216, 0.0024500654232485655, 0.006198509458155265, 0.007024512103504108, 0.014144592509364241, 0.0005082283496705049, 0.004668604518211622, 0.003412217037026647, 0.009025709911742574, 0.009163435233240804, 0.004653381557678882, 0.0032952523386648646, 0.003485472300394992, 0.001315682787243912, 0.006508534937432953, 0.007706974880449648, 0.006412268185547187, 0.0021236463814390486, 0.004652896423824862, 0.006007795068504281, 0.0025776788572805564, 0.0038694700913166668, 0.002126522144962306, 0.0007007030087814724, 0.0009223427800305972, 0.009430930849630667, 0.002515160077786052, 0.006659642710067046, 0.010422373769870449, 0.012215713933765178, 0.009014467752163345, 0.00751295475251428, 0.0001034763500582956, 0.003426095686548777, 0.0058059697086448306, 0.0024709300124416598, 0.018987230206653403, 0.008936181326173092, 0.0007898668125575161, 0.003952417107210014, 0.005408041011667171, 0.0028476768874458646, 0.003250822258996293, 0.0010508639073216767, 0.00644077015199333, 0.0018222922071087998, 0.0004005712132896135, 0.0013917058628470306, 0.010773343988314312, 0.0031571258607125674, 0.01551220263425448, 0.011756677265187174, 0.014252155659741481, 0.0013905646264404643, 0.0028843656522758053, 0.015805781003336572, 0.01212862359838339, 0.011065336638485706, 0.0008409334036086559, 0.008708951334521169, 0.007054033159465468, 0.0014235977099456478, 0.001386212986000295, 0.0012181422740597848, 0.0024826153279567625, 0.003319542317005181, 0.006409961974897196, 0.0057653359169095, 0.004245620258337423, 0.0008380203685045774, 0.008238369122484197, 0.0025290939396195797, 0.008537721293278467, 0.0008840393067684385, 0.003265738068511472, 0.011700827634378673, 0.006780802867929954, 0.005172816712202896, 0.020398318284018994, 0.008988561551185674, 0.010022215729848502, 0.0006699602693646375, 0.004839211185504937, 0.004776027008221469, 0.0030424083592718925, 0.0004975323306547862, 0.001438599556436249, 0.005231405143465632, 0.003170814825389903, 0.006635772257607971, 0.0008044034772081216, 0.00173674413365535, 0.0019203149090224764, 0.009482939402200519, 0.008070371016631689, 0.003613613990141719, 0.002207521278580714, 0.002752764468589231, 0.006546032483260184, 0.00251138921404607, 0.0028156087850038634, 0.0033379530498034416, 0.002050278280439152, 0.006816698824843158, 0.0115521757187089, 0.007603490068330606, 0.00199982782676493, 0.00327616663382351, 0.019691002297251858, 0.00788987891139053, 0.005912117837929495, 0.005368540563710289, 0.002690462222546258, 0.004295417234114204, 0.004903240934808477, 0.011246349244573291, 0.005010111696349234, 0.004859759867522487, 0.0009099075925460219, 0.004742877462731637, 0.0008411344814126842, 0.007736616077161857, 0.004867585425702345, 0.0065418769487126435, 0.0015457529103753062, 0.002274282606863056, 0.005999762221241801, 0.0008203261956050371, 0.01281483414253615, 0.009186160943397803, 0.01474425425955728, 0.0014625175982069096, 0.008368891930448728, 0.01708026490652566, 0.011618895493253664, 0.007075019168911552, 0.006566942166279193, 0.0007883404998547235, 0.00020522977870444215, 0.0048072046749025816, 0.008947926417578337, 0.0011648945255348679, 0.004326039641295498, 0.008236826286745132, 0.006915617727270963, 0.004045086983363008, 0.0008951927922637552, 0.006622501496253029, 0.01655821164938655, 0.0011424434190023265, 0.0069692329904987435, 0.006135447321802508, 0.0077639628338479925, 0.001195640326431284, 0.005020079175363007, 0.004610318620601064, 0.000934904338985337, 0.00782702327111424, 0.0, 0.0, 0.0, 0.0, 0.0028191918647272334, 0.00426490620270324, 0.006857444763485888, 0.0022226834009814456]
maximum(banz)



histogram(banz, bins=50, xlabel="Values", ylabel="Frequency", title="Histogram of Vector")
histogram(ridge, bins=50, xlabel="Values", ylabel="Frequency", title="Histogram of Vector")


indices_b = sortperm(banz)
top_5_indices_b = indices_b[end-4:end]
indices_r = sortperm(ridge)
top_5_indices_r = indices_r[end-4:end]
length(ridge)
length(banz)

dont jump

[0.005318041915623106, 0.002758851938115176, 0.005752334222967927, 0.035302725070769606, 0.007259503305201344, 0.0025269614136590565, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.010858577671837377, 0.018628482477511154, 0.003144957709780153, 0.007407750136007603, 0.014465715454930817, 0.009044069121464495, 0.0005487174006749208, 0.014538625936459064, 0.003102360592602462, 0.003186341397224879, 0.009458452912827901, 0.0004552065064159469, 0.006974693654975749, 0.004585202903516629, 0.002283455645742827, 0.002213514908514893, 0.0030160156506419014, 0.007171300752103531, 0.0, 0.0, 0.02427266033616385, 0.05221985485504533, 0.01924917223220242, 0.0013773430683404182, 0.04217544024547185, 0.05490011255321484, 0.23621019043806127, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0075713386224415865, 0.001122900125394894, 0.0002803403865165508, 0.0022481807381457505, 0.0025327235315637958, 0.008639629581060572, 0.000775264428448641, 0.0009205917836045194, 0.003928088747196117, 0.0070003446283041695, 0.006922710914889206, 0.011895148947613019, 0.016209776475958, 0.014012458595243985, 0.004582091170599652, 0.01123887658546523, 0.011646262786488334, 0.003087787731674105, 0.005271659524006738, 0.006354294557002255, 0.004430045393775098, 0.0034823760870187153, 0.005236360443975921, 0.023875746590583398, 0.010249132892026306, 0.0060869724180847495, 0.0016792332376306704, 0.0, 0.011613431805724694, 0.0009094124609968548, 0.0040812701875000456, 0.004919074676868995, 0.0031877693675006896, 0.019977467859803994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.000583403560305814, 0.012564676389034612, 0.004089901137598999, 0.002301758837391002, 0.0023208271300568482, 0.00621496187080684, 0.00904628236304307, 0.0076095437911256475, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.007153338957277644, 0.0030285989776780535, 0.013531827311702454, 0.00014716316548730042, 0.00043070465286039667, 0.007380180022447158, 0.005213159942795716, 0.014032202357985824, 0.004143408992892002, 0.01132662147023463, 0.0035441912293888897, 0.01134760796099638, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01772121910442023, 0.011685638487269927, 0.0058186245285267784, 0.012351621548975006, 0.0032315527575301505, 0.016631195997253895, 0.008375248497597713, 0.0016557383752184227, 0.0029901962040722254, 0.019830751358760102, 0.007552244087253789, 0.0051756173288140745, 0.005327326480730985, 0.006178433485106854, 0.0014915285160352365, 0.0028739435861588752, 0.006981758903124183, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.012639565473949066, 0.012690114168094875, 0.012969497424606216, 0.015200392450433935, 0.024965904601737667, 0.0130391291507615, 0.006167464962432055, 0.015251610343747373, 0.006290953576525293, 0.002436766261072581, 0.0027297518940756636, 0.00013077563806084135, 0.02837166912223266, 0.009284822400100387, 0.006117773131439821, 0.011303796150968272, 0.0010153475873249103, 0.0053181110511138375, 0.0002855439336851658, 0.01857966640797947, 0.005268109160089536, 0.0021074957828825396, 0.021863406943318026, 0.004869084624540883, 0.010291793785441879, 0.008228404695782825, 0.0048164330523499934, 0.014278342908770345, 0.005761806320286743, 0.014283297838141968, 7.345597324573255e-5, 0.0023462404637622134, 0.002865410321430848, 0.020045493432068774, 0.0019521663392145043, 0.0030274544933781666, 0.010251521603733786, 0.0031664494935135902, 0.00548123107528085, 0.0034690021288841287, 0.0002811287058222213, 0.0059493662001712504, 0.010425581395694924, 0.0011153187238430705, 0.008857225966955967, 0.0005428794495189876, 0.0017139151967427173, 0.008103826487450573, 0.004890549653125547, 0.0018546180352016506, 0.020636952186545925, 0.02918729195995408, 0.01302797212049276, 0.015357099900234268, 0.004078423690111198, 0.0, 0.0, 0.0, 0.0, 0.0, 0.008926688515082796, 0.010548667471945591, 0.014240069500272125, 0.003907319081584752, 0.005131821874459956, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00035791014745893934, 0.012616539785667725, 0.0064502421684179976, 0.003906628977292542, 4.2172130753982784e-5, 0.00898587920641732, 0.007805066503825325, 0.00402491581346673, 0.017031623586351803, 0.0036604127368039443, 0.0021173795440943854, 0.005000264193115469, 0.00324854355008321, 0.003678887663108728, 0.01616348012252778, 0.0212722322962487, 0.009623962318189598, 0.0036315203017092926, 0.002251030168097163, 0.011154413885168612, 0.0034727667692284435, 0.00442273243904484, 0.006564575163238597, 0.0019348574838342215, 0.009007142803576423, 0.017439795559746542, 0.00025363169916211003, 0.012038224296295206, 0.01089442890151435, 0.005134656263182765, 0.018862550630806912, 0.0018511345914329757, 0.0015925739258774384, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0062640566394634506, 0.012619838921672793, 0.006920190511476613, 0.004151038302136225, 0.0018789953210179766, 0.007599791792668225, 0.0, 0.0, 0.0, 0.013552570134896047, 0.02114815189222107, 0.014567336246443898, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.008194065390959352, 0.004320823840214663, 0.0040546227324588825, 0.003961231570275701, 0.008364280174277205, 0.01507128209443487, 0.0001601684865763334, 0.019700702011653852, 0.0015516740917668286, 0.007311138357473749, 0.0035675714085727137, 0.012838886200211171, 0.0033384077629605943, 0.01029938437361958, 6.154613031798809e-5, 0.0037044065197680796, 0.009344476418028172, 0.0016491713343019462, 0.0010012428922311016, 0.019589637377193766, 0.007456053733977739, 0.005475406826773582, 0.005192337100970822, 0.007038203231751573, 0.016766712109819726, 0.009436262963614835, 0.009432553553978297, 0.002910194694371679, 0.008106861536833371, 0.00405338151741497, 6.304375467977166e-5, 0.0010957760240699233, 0.0019306289262063482, 0.001963102403316094, 0.011418264552482326, 0.020685551243661397, 0.011015138335375272, 0.009380079227835856, 0.010831180345870382, 0.015755508672541475, 0.0013355282266593643, 0.0059054450741259585, 0.007610461717389183, 0.008233853316803933, 0.002092069996464373, 0.0004598556551436773, 0.018314216176192614, 0.006621165879084911, 0.00804652654416824, 0.007692746570167755, 0.01035023087838622, 0.010162429150058095, 0.010745180875395815, 0.001452370235563974, 0.0023155794667342406, 0.00267158996188731, 0.013407004823967922, 0.01119570529241642, 0.00020028293832856042, 0.01147884145903009, 0.01254648413441725, 0.004690597251729223, 0.007996626872937772, 0.0033615180563547832, 0.0089622255196608, 0.00913642449322133, 0.003854409543401494, 0.00020311827713291096, 0.005530623200119053, 0.03003987380926554, 0.009438953810882836, 0.0011980782294444131, 0.012193668591379705, 0.008254260413707797, 0.005772619251911809, 0.020667364224182423, 0.010768706254386582, 0.0055219872558453335, 0.0041848654975660746, 0.002992450416260191, 0.00024162384482544457, 0.0017918267392077968, 0.0007598410364335304, 0.002104493140040774, 0.0033072584249788715, 0.01606271195865744, 0.005341816789721785, 0.004843229112684753, 0.01082793729322495, 0.0039858756418237095, 0.0003014039547960522, 0.0002104513408850474, 0.0007583602507982356, 0.013544797832480379, 0.003138820859522904, 0.005468667309520508, 0.0013214241142059174, 0.0045756238026180545, 0.0005337214221296664, 0.0020475980233525697, 0.0013150941288737187, 0.009909114817230906, 0.0071482727876742294, 0.00888355034304874, 0.01227210735896522, 0.014783775138364536, 0.011722417496339378, 0.012034109370014262, 0.0098414442099593, 0.013451485019142638, 0.003913021790370602, 0.0034761736274909758, 0.00860938375299085, 0.004964326392789813, 0.0006989334963989894, 0.012566316558607526, 0.004502642373268969, 0.008982146824751189, 0.0018051548006064236, 0.0028518452388843554, 0.0019698956309960056, 0.008800669345408461, 0.007456045927079597, 0.019641992070863257, 0.003500903866185637, 0.0014845578475314596, 0.0008489334256834945, 0.017017538284440022, 0.009197974034284538, 0.005512895703222542, 0.003401622464590157, 0.005348828110175633, 0.0073488901539529436, 0.0075395471834261195, 0.004164867315025524, 0.006451195601080747, 0.016915096220048945, 0.027181341160613177, 0.010998690217970897, 0.00026644656424536483, 0.003746306217998868, 0.011971680282749175, 0.0019855494664898087, 0.004728966810751271, 0.0003004859292097022, 0.0040089652221573175, 0.01618025440540787, 0.004124722878525578, 0.007887341450646516, 0.005473952747789613, 0.008927792217087263, 0.0042813201850486985, 0.008956048625163597, 0.001833682987617224, 0.009032577614395769, 0.007280337577568954, 0.00604221904537593, 0.0024295922220088986, 0.0050720673032489194, 0.01393568607710473, 0.011403683328629654, 0.004430557757749407, 0.01468840320601953, 0.007227762214420477, 0.0074307698256572486, 0.003709821214868757, 0.005164792515602577, 0.0010233018589053031, 0.022459884416805295, 0.00029855134043418516, 0.0030051239931907854, 0.00271725597561378, 0.00633572279731178, 0.0010898996608179657, 0.0014193812476720846, 0.005455837343797627, 0.012155282127607336, 0.00017891151683248192, 0.01038668466608641, 0.008644231083423671, 0.0022711974286525527, 0.006156380483780477, 0.0035874039961651615, 0.005496165191012513, 0.007467724778074358, 0.001965712383765987, 0.000549729325805917, 0.007358323590827038, 0.0034968439040509005, 0.015476100716007973, 0.003028052345472592, 0.0038426550225227796, 0.010557976293333592, 0.0077049022559966636, 0.009081007876552697, 0.0053753285806570445, 0.004164231569952948, 0.00424503427306887, 0.007197543257285034, 0.0, 0.0, 0.0, 0.0, 0.01980662606685478, 0.001618133710042563, 0.021462663608196722, 0.0027997501441710416][301]
# mask = treelime(ds[18], logsoft_model, extractor, sch, 10, 0.28, "missing")
# logical = ExplainMill.e2boolean(ds[18], mask, extractor)
# logical_json = JSON.json(logical)
# filename = "explanation_with_inner.json"
# open(filename, "w") do f
#     write(f, logical_json)
# end
# ExplainMill.confidencegap(soft_model, extractor(logical), 6)[1, 1]

# e = LimeExplainer(sch, extractor, 100, 0.5)
# dd = ds[18]
# pruning_method = :Flat_HAdd
# rel_tol = 0.9
# lime_mask = ExplainMill.explain(e, ds[18], logsoft_model, pruning_method=pruning_method, rel_tol=rel_tol)
# open("lime.json", "w") do f
#     write(f, JSON.json(ExplainMill.e2boolean(dd, lime_mask, extractor)))
# end
# ExplainMill.confidencegap(soft_model, extractor(ExplainMill.e2boolean(dd, lime_mask, extractor)), 6)[1, 1]


# printtree(ds[1])
# printtree(ds[1].data[:behavior][:summary])

# time_split_complete_schema

# for i in 1:1
#     println("This is iteration number $i")
# end
# ms = ExplainMill.explain(ExplainMill.GradExplainer(), ds[1], logsoft_model, predictions[1], pruning_method=:Flat_HAdd, abs_tol=0.8)
# logical = ExplainMill.e2boolean(ds[1], ms, extractor)

# OneHotArrays

# BSON.@save resultsdir(stats_filename) exdf

# Flux.OneHotMatrix <: Mill.MaybeHotMatrix
# variants[1]

# my_ngram = nothing

# my_ngramx